\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{minted}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\usemintedstyle{monokai}

\title{\textbf{Visualizing Linear Regression}}
\author{Niranjan Krishna\\
		realniranjankrishna@gmail.com\\}

\begin{document}

\maketitle
\section{Introduction}
This is the first article in a series of articles which have the common goal of visualizing machine learning algorithms. So why visualize a machine learning algorithm?
\begin{enumerate}
\item It looks cool
\item It helps you understand more about what the algorithm does underneath all the high level code.
\end{enumerate}
We're gonna be using p5.js in javascript to visualize all the algorithms. Today we are going to be visualizing Linear Regression. Let's get to it.

\section{Setup}
First, let's create a p5 js project called LinearRegression.
\begin{minted}[bgcolor=black]{python}
 p5 g -b LinearRegression
 \end{minted}
Now our project should be set up with all the libraries included. If you don't have the p5 project manager install that and come back to this tutorial or manually setup your folder with the necessary libraries.

\section{Idea}
So the basic idea is that the user gets an interactive visualization of Linear Regression. Basically, when a user clicks on a point on the canvas it becomes a data point. And upon clicking a point the p5.js code interactively draws the best fit line to all the points present in the canvas. Pretty cool, right? Let's get to implementing it.

\section{Implementation}
First, let's implement a mouse click function.

\begin{minted}[bgcolor=black]{javascript}
function mouseClicked() {
  console.log("Mouse Clicked")
}
\end{minted}
Now we want to get the coordinates of the mouse click and store that into a data array. Let's also initialize the weight and bias
\begin{minted}[bgcolor=black]{javascript}

let data = [];
let w = 0;
let b = 0;
\end{minted}

Now every time the mouse is clicked, we want to store the data into an array and compute the weight and bias for that particular data. Let's store the mouseCoordinates into the data array.
\begin{minted}[bgcolor=black]{javascript}

data.push([mouseX,mouseY]);
\end{minted}

Let's figure out how to compute the weight and bias. What we're trying to do is minimize the error, between out predicted output and the actual output. For that we need to have an error function. We're going to use Least Squared Regression for this tutorial.
\[E = \sum_{i=1}^{N}(y_{i} - p_{i})^2\]
Here \(y_{i}\) is the ith y value and \(p_{i}\) is the ith predicted value. Since \(p_{i} = w\cdot{}x_{i} + b\), we can also write this as
\[E = \sum_{i=1}^{N}(y_{i} - (w\cdot{}x_{i} + b))^2\]
Next, we need to find the value of w and b that will produce the minimum value of this function. We've learned from calculus that in order to find the minimum of a function we need to take the partial derivative with respect to the variable, set it to zero and solve for the variable.
First let's expand this expression
\[E = \sum_{i=1}^{N}(y_{i}^2 + (w\cdot{}x_{i} + b)^2 - 2\cdot{}y_{i}\cdot{}(w\cdot{x}+b))\]
\[= \sum_{i=1}^{N}(y_{i}^2 + w^2\cdot{}x_{i}^2 + b^2+2\cdot{}w\cdot{b}\cdot{}x_{i} - 2w\cdot{}y_{i}\cdot{x_{i}}-2b\cdot{}y_{i})\]
Separating the sums and rewriting this gives us
\[ = \sum_{i=1}^{N}y_{i}^2+w^2\sum_{i=1}^{N}x_{i}^2+\sum_{i=1}^{N}b^2+2wb\sum_{i=1}^{N}x_{i}-2w\sum_{i=1}^{N}x_{i}y_{i}-2b\sum_{i=1}^{N}y_{i}\]
\[ = \sum_{i=1}^{N}y_{i}^2+w^2\sum_{i=1}^{N}x_{i}^2+b^2N+2wb\sum_{i=1}^{N}x_{i}-2w\sum_{i=1}^{N}x_{i}y_{i}-2b\sum_{i=1}^{N}y_{i}\]
Finding the derivative respect to w gives us
\[\frac{\partial E}{\partial w} = \frac{\partial }{\partial w}\sum_{i=1}^{N}y_{i}^2+\frac{\partial }{\partial w}w^2\sum_{i=1}^{N}x_{i}^2+\frac{\partial }{\partial w}b^2N+\frac{\partial }{\partial w}2wb\sum_{i=1}^{N}x_{i}-\frac{\partial }{\partial w}2w\sum_{i=1}^{N}x_{i}y_{i}-\frac{\partial }{\partial w}2b\sum_{i=1}^{N}y_{i} \]
\[ = 0+2w\sum_{i=1}^{N}x_{i}^2+0+2b\sum_{i=1}^{N}x_{i}-2\sum_{i=1}^{N}x_{i}y_{i}+0\]
Therefore
\[2w\sum_{i=1}^{N}x_{i}^2+2b\sum_{i=1}^{N}x_{i}-2\sum_{i=1}^{N}x_{i}y_{i} = 0\]
\[w\sum_{i=1}^{N}x_{i}^2+b\sum_{i=1}^{N}x_{i}-\sum_{i=1}^{N}x_{i}y_{i} = 0\]
\[w =\frac{ \sum_{i=1}^{N}x_{i}y_{i} - b\sum_{i=1}^{N}x_{i}}{\sum_{i=1}^{N}x_{i}^2}\]
Proceeding in similar fashion for b
\[\frac{\partial E}{\partial b} = \frac{\partial }{\partial b}\sum_{i=1}^{N}y_{i}^2+\frac{\partial }{\partial b}w^2\sum_{i=1}^{N}x_{i}^2+\frac{\partial }{\partial b}b^2N+\frac{\partial }{\partial b}2wb\sum_{i=1}^{N}x_{i}-\frac{\partial }{\partial b}2w\sum_{i=1}^{N}x_{i}y_{i}-\frac{\partial }{\partial b}2b\sum_{i=1}^{N}y_{i} \]
\[ = 0+0+2bN+2w\sum_{i=1}^{N}x_{i}+0-2\sum_{i=1}^{N}y_{i}\]
Therefore
\[ 2bN+2w\sum_{i=1}^{N}x_{i}-2\sum_{i=1}^{N}y_{i} = 0\]
\[ bN+w\sum_{i=1}^{N}x_{i}-\sum_{i=1}^{N}y_{i} = 0\]
\[ b = \frac{\sum_{i=1}^{N}y_{i}-w\sum_{i=1}^{N}x_{i}}{N}\]
So we derived the required formulas for w and b. Now it's time to code them. Let's iterate over a loop, finding each summation and using them to calculate w and b
\begin{minted}[bgcolor=black]{javascript}
for(var i = 0;i<data.length;i++){
		xsquared+=Math.pow(data[i][0],2)
		xsum+=data[i][0]
		xyproduct+=data[i][0]*data[i][1]
		ysum+=data[i][1]
	}
	w = ((xyproduct - b*xsum)/xsquared)
	b = (ysum - w*xsum)/data.length
\end{minted}
Now we have to plot the points and draw the line as it is a visualization project. We are going to use the draw function to draw them.
\begin{minted}[bgcolor=black]{python}
function draw() {
	background(0);
	for(var i = 0;i<data.length;i++){
		
		fill(255);
		stroke(255);
		ellipse(data[i][0],data[i][1],5,5);
	}
	ybegin = b;
	yend = w*windowWidth+b;
	strokeWeight(2)
	line(0,ybegin,windowWidth,yend)
}
\end{minted}
Here's the full code:
\begin{minted}[bgcolor=black]{js}
let data = [];
let w = 0;
let b = 0;
function setup() {
	createCanvas(windowWidth,windowHeight);
	
}

function draw() {
	background(0);
	for(var i = 0;i<data.length;i++){
		
		fill(255);
		stroke(255);
		ellipse(data[i][0],data[i][1],5,5);
	}
	ybegin = b;
	yend = w*windowWidth+b;
	strokeWeight(2)
	line(0,ybegin,windowWidth,yend)
}
function mouseClicked() {
	data.push([mouseX,mouseY]);
	xsquared = 0;
	xsum = 0;
	xyproduct = 0;
	ysum = 0;
	for(var i = 0;i<data.length;i++){
		xsquared+=Math.pow(data[i][0],2)
		xsum+=data[i][0]
		xyproduct+=data[i][0]*data[i][1]
		ysum+=data[i][1]
	}
	w = ((xyproduct - b*xsum)/xsquared)
	b = (ysum - w*xsum)/data.length
	
}
Here's the github link : - 
\end{minted}
Here's the Github link : - \href{https://github.com/The-CS-Student/VisualML/}{Link} 
\end{document}
